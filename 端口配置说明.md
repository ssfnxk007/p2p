# ç«¯å£é…ç½®å¿«é€Ÿå‚è€ƒ

## ğŸ¯ æ ¸å¿ƒé…ç½®

### æœ¬åœ°ç›‘å¬ç«¯å£ï¼š1430ï¼ˆä½ çš„éœ€æ±‚ï¼‰

```csharp
// åœ¨ P2PSQLAccessClient.cs ç¬¬109è¡Œ
var sqlProxy = new P2PSQLTunnelClient(puncher, logger, 1430);  // âœ… æœ¬åœ°1430
```

### è¿æ¥å­—ç¬¦ä¸²

```csharp
// ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨
string connectionString = "Server=localhost,1430;Database=MyDB;User Id=sa;Password=xxx;";
                                         // â†‘â†‘â†‘â†‘ æ³¨æ„è¿™é‡Œæ˜¯1430
```

## ğŸ“Š å®Œæ•´ç«¯å£åˆ†é…è¡¨

| ç«¯å£ | ä½ç½® | æœåŠ¡ | è¯´æ˜ |
|------|------|------|------|
| **1430** | å®¢æˆ·ç«¯æœ¬åœ° | SQLä»£ç†ç›‘å¬ | **ä½ è®¿é—®çš„ç«¯å£** |
| 1433 | æœåŠ¡ç«¯æœ¬åœ° | SQL Server | çœŸå®æ•°æ®åº“ |
| 8000 | äº‘æœåŠ¡å™¨ | P2Påè°ƒ | UDPåè®® |
| 9999 | ä¸¤ç«¯æœ¬åœ° | TCPæµ‹è¯•ç«¯å£ | å¯é€‰æµ‹è¯•ç”¨ |

## ğŸ”„ æ•°æ®æµå‘

```
ä½ çš„åº”ç”¨
  â†“
localhost:1430 (SQLä»£ç†)
  â†“
P2P UDPéš§é“ (é€šè¿‡8000åè°ƒ)
  â†“
æœåŠ¡ç«¯SQLéš§é“
  â†“
localhost:1433 (SQL Server)
```

## âš™ï¸ ä¿®æ”¹ç«¯å£çš„æ–¹æ³•

### å¦‚æœæƒ³æ”¹ä¸ºå…¶ä»–ç«¯å£ï¼ˆä¾‹å¦‚1435ï¼‰

#### 1. ä¿®æ”¹ä»£ç 

**æ–‡ä»¶**ï¼š`P2PSQLAccessClient.cs`

```csharp
// ç¬¬109è¡Œï¼Œå°†1430æ”¹ä¸º1435
var sqlProxy = new P2PSQLTunnelClient(puncher, logger, 1435);
```

#### 2. ä¿®æ”¹è¿æ¥å­—ç¬¦ä¸²

```csharp
// ä½ çš„åº”ç”¨ä¸­
string connectionString = "Server=localhost,1435;...";
                                         // â†‘â†‘â†‘â†‘ æ”¹ä¸º1435
```

#### 3. é‡æ–°ç¼–è¯‘

```powershell
cd d:\Ksa_p2pç›´è”
dotnet build P2PSQLAccessClient.cs -o TestDeploy/AccessClient
```

## ğŸš« ä¸éœ€è¦ä¿®æ”¹çš„é…ç½®

ä»¥ä¸‹é…ç½®**ä¸è¦æ”¹åŠ¨**ï¼ˆé™¤éä½ çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼‰ï¼š

- âŒ æœåŠ¡ç«¯SQL Serverç«¯å£ï¼ˆ1433ï¼‰
- âŒ P2Påè°ƒæœåŠ¡å™¨ç«¯å£ï¼ˆ8000ï¼‰
- âŒ GroupID / GroupKeyï¼ˆå¿…é¡»ä¿æŒä¸€è‡´ï¼‰
- âŒ æœåŠ¡å™¨IPï¼ˆ42.51.41.138ï¼‰

## âœ… å½“å‰é…ç½®æ€»ç»“

### è®¿é—®å®¢æˆ·ç«¯ï¼ˆä½ çš„æœºå™¨ï¼‰
```json
{
  "PeerID": "è®¿é—®å®¢æˆ·ç«¯",
  "GroupID": "æµ‹è¯•ç»„1",
  "GroupKey": "test123",
  "Servers": ["42.51.41.138"],
  "ServerPort": 8000
}
```
- **æœ¬åœ°ç›‘å¬**ï¼š1430ç«¯å£
- **è¿æ¥å­—ç¬¦ä¸²**ï¼š`Server=localhost,1430;...`

### æœåŠ¡æä¾›ç«¯ï¼ˆæœ‰SQL Serverçš„æœºå™¨ï¼‰
```json
{
  "PeerID": "æœåŠ¡æä¾›ç«¯",
  "GroupID": "æµ‹è¯•ç»„1",
  "GroupKey": "test123",
  "Servers": ["42.51.41.138"],
  "ServerPort": 8000
}
```
- **SQL Server**ï¼šæœ¬åœ°1433ç«¯å£
- **è½¬å‘ç›®æ ‡**ï¼š127.0.0.1:1433

## ğŸ‰ å®Œæˆï¼

é…ç½®å·²è®¾ç½®ä¸ºï¼š
- âœ… æœ¬åœ°è®¿é—®ç«¯å£ï¼š**1430**
- âœ… æœåŠ¡ç«¯SQLç«¯å£ï¼š1433
- âœ… æ‰€æœ‰JSONé…ç½®åŒ¹é…
- âœ… ä»£ç å·²å‡†å¤‡å°±ç»ª

**ä¸‹ä¸€æ­¥**ï¼š
1. ç¼–è¯‘ä¸¤ä¸ªæ–°ç¨‹åºï¼ˆè§ `SQLéš§é“éƒ¨ç½²è¯´æ˜.md`ï¼‰
2. å…ˆå¯åŠ¨æœåŠ¡ç«¯
3. å†å¯åŠ¨å®¢æˆ·ç«¯
4. ä½¿ç”¨ `Server=localhost,1430` è¿æ¥

---

**å¿«é€Ÿæµ‹è¯•å‘½ä»¤**ï¼š
```powershell
# ç¼–è¯‘
cd d:\Ksa_p2pç›´è”
dotnet build

# æµ‹è¯•å®¢æˆ·ç«¯ï¼ˆå¯åŠ¨åè¾“å…¥testå‘½ä»¤ï¼‰
cd TestDeploy\AccessClient
.\P2PSQLAccessClient.exe
> test
```
