========================================
  P2P é€šä¿¡ç³»ç»Ÿæž¶æž„å›¾
========================================


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å…¬ç½‘æœåŠ¡å™¨                                   â”‚
â”‚                     (P2PServer.exe)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  â€¢ ç›‘å¬ç«¯å£: 8000                                           â”‚     â”‚
â”‚  â”‚  â€¢ ç»„ç®¡ç†: group_sql, group_chat                           â”‚     â”‚
â”‚  â”‚  â€¢ åŠŸèƒ½:                                                    â”‚     â”‚
â”‚  â”‚    - å®¢æˆ·ç«¯æ³¨å†Œï¼ˆéªŒè¯ç»„å¯†é’¥ï¼‰                                â”‚     â”‚
â”‚  â”‚    - å¿ƒè·³ä¿æŒï¼ˆ1ç§’é—´éš”ï¼‰                                     â”‚     â”‚
â”‚  â”‚    - NATç©¿é€è¾…åŠ©                                            â”‚     â”‚
â”‚  â”‚    - é™çº§ä¸­è½¬è½¬å‘                                            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚               â”‚
           â–¼               â–¼               â–¼
    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¢æˆ·ç«¯ A    â”‚  â”‚  å®¢æˆ·ç«¯ B    â”‚  â”‚  å®¢æˆ·ç«¯ C    â”‚
â”‚ (å†…ç½‘NATåŽ)  â”‚  â”‚ (å†…ç½‘NATåŽ)  â”‚  â”‚ (å†…ç½‘NATåŽ)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ç»„: sql           ç»„: sql           ç»„: chat
   è§’è‰²: è®¿é—®ç«¯      è§’è‰²: æœåŠ¡ç«¯      è§’è‰²: èŠå¤©
   
   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€è¿žæŽ¥æµç¨‹ã€‘

æ­¥éª¤1: æ³¨å†Œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€
å®¢æˆ·ç«¯A                       æœåŠ¡å™¨                      å®¢æˆ·ç«¯B
   â”‚                             â”‚                            â”‚
   â”œâ”€â”€â”€â”€ REGISTER:A:sql:key â”€â”€â”€â”€>â”‚                            â”‚
   â”‚                             â”‚                            â”‚
   â”‚<â”€â”€â”€â”€â”€ OK:å…¬ç½‘IP:ç«¯å£ â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
   â”‚                             â”‚                            â”‚
   â”‚                             â”‚<â”€â”€â”€â”€ REGISTER:B:sql:key â”€â”€â”€â”¤
   â”‚                             â”‚                            â”‚
   â”‚                             â”œâ”€â”€â”€â”€â”€ OK:å…¬ç½‘IP:ç«¯å£ â”€â”€â”€â”€â”€â”€>â”‚


æ­¥éª¤2: å¿ƒè·³ä¿æŒ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å®¢æˆ·ç«¯A                       æœåŠ¡å™¨                      å®¢æˆ·ç«¯B
   â”‚                             â”‚                            â”‚
   â”œâ”€â”€â”€â”€ HEARTBEAT:A (æ¯1ç§’) â”€â”€>â”‚                            â”‚
   â”‚                             â”‚<â”€â”€â”€â”€ HEARTBEAT:B (æ¯1ç§’) â”€â”€â”¤
   â”‚                             â”‚                            â”‚
   â–¼                             â–¼                            â–¼
   ä¿æŒNATæ˜ å°„æ´»è·ƒ          è®°å½•åœ¨çº¿çŠ¶æ€            ä¿æŒNATæ˜ å°„æ´»è·ƒ


æ­¥éª¤3: P2P æ‰“æ´žï¼ˆä¼˜å…ˆï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å®¢æˆ·ç«¯A                                                    å®¢æˆ·ç«¯B
   â”‚                                                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PUNCHåŒ… (å°è¯•1/10) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                                                          â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PUNCH_OKåŒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                                          â”‚
   â”‚âœ… P2Pç›´è¿žæˆåŠŸï¼                                         â”‚
   â”‚                                                          â”‚
   â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UDP ç›´æŽ¥é€šä¿¡ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•>â”‚
   â”‚                 (å»¶è¿Ÿ: 5-50ms)                           â”‚
   â”‚<â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚


æ­¥éª¤4: é™çº§ä¸­è½¬ï¼ˆå¤±è´¥æ—¶ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å®¢æˆ·ç«¯A                       æœåŠ¡å™¨                      å®¢æˆ·ç«¯B
   â”‚                             â”‚                            â”‚
   â”œâ”€ RELAY_START:A:B â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
   â”‚                             â”‚                            â”‚
   â”‚<â”€â”€â”€â”€ RELAY_OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
   â”‚                             â”‚                            â”‚
   â”œâ”€ RELAY_DATA:æ¶ˆæ¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
   â”‚                             â”‚                            â”‚
   â”‚                             â”œâ”€â”€â”€ RELAYED:A:æ¶ˆæ¯ â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                             â”‚                            â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<â”€ RELAY_DATA:å›žå¤ â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                             â”‚                            â”‚


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€ç«¯å£è½¬å‘æµç¨‹ã€‘

æœ¬åœ°åº”ç”¨               å®¢æˆ·ç«¯A                å®¢æˆ·ç«¯B              è¿œç¨‹æœåŠ¡
   â”‚                     â”‚                      â”‚                     â”‚
   â”‚ SQLæŸ¥è¯¢             â”‚                      â”‚                     â”‚
   â”œâ”€â”€> localhost:1433â”€â”€>â”‚                      â”‚                     â”‚
   â”‚                     â”‚                      â”‚                     â”‚
   â”‚                     â”œâ”€ UDPåŒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
   â”‚                     â”‚  (P2P/ä¸­è½¬)          â”‚                     â”‚
   â”‚                     â”‚                      â”œâ”€â”€> localhost:1433â”€â”€>â”‚
   â”‚                     â”‚                      â”‚     SQL Server      â”‚
   â”‚                     â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
   â”‚                     â”‚                      â”‚                     â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                     â”‚
   â”‚ SQLç»“æžœ             â”‚                      â”‚                     â”‚


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€ç»„éš”ç¦»æœºåˆ¶ã€‘

            æœåŠ¡å™¨
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚
   ç»„: sql        ç»„: chat
        â”‚             â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”     â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â”‚       â”‚     â”‚       â”‚
  å®¢æˆ·ç«¯A  å®¢æˆ·ç«¯B  å®¢æˆ·ç«¯C å®¢æˆ·ç«¯D
    â”‚       â”‚     â”‚       â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”˜
        â”‚             â”‚
    åªèƒ½äº’ç›¸é€šä¿¡    åªèƒ½äº’ç›¸é€šä¿¡
    âŒ æ— æ³•è·¨ç»„     âŒ æ— æ³•è·¨ç»„


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€è¿žæŽ¥çŠ¶æ€æ˜¾ç¤ºã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [2025-01-04 10:01:05.200] [INFO]               â”‚
â”‚ [è¿žæŽ¥] ClientB                                  â”‚
â”‚ ç±»åž‹: âš¡ P2Pç›´è¿ž                               â”‚
â”‚ å»¶è¿Ÿ: 15ms                                      â”‚
â”‚ çŠ¶æ€: æ­£å¸¸                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å›¾æ ‡è¯´æ˜Ž:
  âš¡ P2Pç›´è¿ž     - UDPç‚¹å¯¹ç‚¹é€šä¿¡ï¼ˆæœ€å¿«ï¼Œ70-85%æˆåŠŸçŽ‡ï¼‰
  ðŸ”„ æœåŠ¡å™¨ä¸­è½¬   - é€šè¿‡æœåŠ¡å™¨è½¬å‘ï¼ˆå…œåº•ï¼Œ100%æˆåŠŸï¼‰
  ðŸŒ ç«¯å£è½¬å‘    - æœ¬åœ°ç«¯å£æ˜ å°„åˆ°è¿œç¨‹


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€æ–‡ä»¶ç»“æž„ã€‘

é¡¹ç›®æ ¹ç›®å½•
â”‚
â”œâ”€â”€ P2PServer.exe          â† ç¼–è¯‘åŽçš„æœåŠ¡å™¨ç¨‹åº
â”œâ”€â”€ P2PClient.exe          â† ç¼–è¯‘åŽçš„å®¢æˆ·ç«¯ç¨‹åº
â”‚
â”œâ”€â”€ server_config.json     â† æœåŠ¡å™¨é…ç½®
â”‚   â””â”€â”€ å®šä¹‰: ç«¯å£ã€ç»„ã€å¯†é’¥
â”‚
â”œâ”€â”€ client_config.json     â† å®¢æˆ·ç«¯é…ç½®
â”‚   â””â”€â”€ å®šä¹‰: èŠ‚ç‚¹IDã€ç»„IDã€å¯†é’¥ã€ç«¯å£è½¬å‘è§„åˆ™
â”‚
â”œâ”€â”€ logs/                  â† æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ p2p_20250104.log  â† æŒ‰æ—¥æœŸè‡ªåŠ¨åˆ›å»º
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ æºä»£ç æ–‡ä»¶
    â”œâ”€â”€ P2PServerMain.cs   â† æœåŠ¡å™¨ä¸»ç¨‹åº
    â”œâ”€â”€ P2PServer.cs       â† æœåŠ¡å™¨æ ¸å¿ƒ
    â”œâ”€â”€ P2PClient.cs       â† å®¢æˆ·ç«¯ä¸»ç¨‹åº
    â”œâ”€â”€ P2PPuncher.cs      â† P2Pæ‰“æ´žæ ¸å¿ƒ
    â”œâ”€â”€ P2PConfig.cs       â† é…ç½®å’Œæ—¥å¿—ç³»ç»Ÿ
    â””â”€â”€ PortForwarder.cs   â† ç«¯å£è½¬å‘æ¨¡å—


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€æŠ€æœ¯ç‰¹æ€§å¯¹æ¯”ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç‰¹æ€§       â”‚  P2Pç›´è¿ž   â”‚  æœåŠ¡å™¨ä¸­è½¬ â”‚  ç«¯å£è½¬å‘  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å»¶è¿Ÿ         â”‚ 5-50ms     â”‚ 50-200ms   â”‚ +5-50ms    â”‚
â”‚ æˆåŠŸçŽ‡       â”‚ 70-85%     â”‚ 100%       â”‚ ä¾èµ–è¿žæŽ¥   â”‚
â”‚ æœåŠ¡å™¨åŽ‹åŠ›   â”‚ å‡ ä¹Žä¸º0    â”‚ è½¬å‘å…¨æµé‡ â”‚ è½¬å‘å…¨æµé‡ â”‚
â”‚ é€‚ç”¨åœºæ™¯     â”‚ å®žæ—¶é€šä¿¡   â”‚ å…œåº•æ–¹æ¡ˆ   â”‚ é€æ˜Žè®¿é—®   â”‚
â”‚ NATè¦æ±‚      â”‚ éžå¯¹ç§°NAT  â”‚ æ— è¦æ±‚     â”‚ æ— è¦æ±‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ã€éƒ¨ç½²å»ºè®®ã€‘

1. æœåŠ¡å™¨ç«¯ï¼ˆå…¬ç½‘ï¼‰
   â”œâ”€â”€ é…ç½®: 1æ ¸2Gï¼Œ5Mbpså¸¦å®½
   â”œâ”€â”€ æˆæœ¬: ï¿¥9.9/æœˆï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰
   â”œâ”€â”€ å®¹é‡: æ”¯æŒ100-500å¹¶å‘ç”¨æˆ·
   â””â”€â”€ ç«¯å£: å¼€æ”¾ UDP 8000

2. å®¢æˆ·ç«¯ï¼ˆå†…ç½‘ï¼‰
   â”œâ”€â”€ é…ç½®: æ™®é€šPCå³å¯
   â”œâ”€â”€ ç½‘ç»œ: å…è®¸UDPå‡ºç«™
   â””â”€â”€ é˜²ç«å¢™: å…³é—­æˆ–æ”¾è¡ŒUDP

3. æ‰©å±•æ–¹æ¡ˆ
   â”œâ”€â”€ åŒæœåŠ¡å™¨: ä¸»å¤‡å†—ä½™ï¼ˆ99.99%å¯ç”¨æ€§ï¼‰
   â”œâ”€â”€ å¤šåœ°åŸŸ: äºšæ´²ã€æ¬§æ´²ã€ç¾Žæ´²
   â””â”€â”€ è´Ÿè½½å‡è¡¡: 1000+ å¹¶å‘ç”¨æˆ·


========================================
